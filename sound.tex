%% Proof for the soundness theorem + foreword
\section{Proof for the soundness theorem}
\label{app:theosound}

Let us repeat our statement:
We prove that for every two sequences of commands 
\begin{gather*}
S\equiv S^* \implies \forall F: SF=S^*F,\\
S\eqexp S^* \implies \forall F:(SF\ne\ud \implies SF=S^*F).
\end{gather*}

Both statements are true if our axioms and inference rules are sound,
beacuse
we can only generate equivalent (or extending) sequences from axioms
or by using inference rules.

First, we prove the soundness of our inference rules. The proof for the
first two inference rules are quite similar. For the first one, we know
that the intended interpretation of \(S_1\equiv S_2\) is true and our
statement is that for every \(S,S'\), the interpretation of
\(S;S_1;S'\equiv S;S_2;S'\) holds. 
We know that for every filesystem
\(F\), \((S;S_1;S')F=S'(S_1(SF))\) and similarly
\(((S;S_2;S')F=S'(S_2(SF))\). We know that for every
\(G\), \(S_1G=S_2G\) holds, and therefore
as a special case \(S_1(SF)=S_2(SF)\). Thus
\(\forall F: (S;S_1;S')F=(S;S_2;S')F\). This is the interpretation of our
statement.

For the second law, we now that the interpretation of 
\(S_1\eqexp S_2\) is true and we show that
\(S;S_1;S'\eqexp S;S_2;S'\) also true for filesystems. 
We know that for every \(F\) if \(S_1F\ne\ud\) then \(S_1F=S_2F\). If
\((S;S_1;S')F=\ud\) then the relation is clearly true (since it refers to
only the case if the filesystem is not broken). Otherwise, if
\((S;S_1;S')F=S'(S_1(SF))\ne\ud\), we know that \(SF\ne\ud\) since
a filesystem cannot be made non--broken again by applying commands to it.
Now since \(S_1\eqexp S_2\) is true therefore either 
\(S_1(SF)=\ud\) and the relation is true similarly to the case above;
or \(S_1(SF)\ne\ud\) and therefore
\(S_1(SF)=S_2(SF)\ne\ud\) and \(S'(S_1(SF))=S'(S_2(SF))\ne\ud\).

The soundness proof of the third law is quite simple as if two
sequences act the same on \emph{all} filesystems then they act the same on
a subset of the filesystems, too.

It remains to show the soundness of each individual law,
which can be verified based on the definitions of the commands from which
the laws have been derived.
Appendix~\ref{app:soundness} shows an example of the precise proofs.

Our theorem is proved.

